---
title: "Maternal Seperation"
format: html
editor: visual
---

#### Figure 1c 

```{r}
library(tidyverse)
f<-"https://raw.githubusercontent.com/meganhall719/_Data-Analysis-Replication_/refs/heads/main/Data/Figure%201C.csv"

d<-read_csv(f, col_names = TRUE)
head(d)
```


```{r}
# Load required libraries
library(ggplot2)
library(dplyr)
library(tidyr)

# First, examine the structure of your data to understand it better
# str(d)

# Create a clean data frame, making all  values  numeric
d_clean <- data.frame(
  Con = as.numeric(unlist(d[2])),  
  Sus = as.numeric(unlist(d[3])),
  Res = as.numeric(unlist(d[4]))
)

d_clean

```

```{r}

# Reshape the data from wide to long format
data_long <- pivot_longer(
  d_clean,
  cols = everything(),
  names_to = "Group",
  values_to = "Social_interaction_ratio"
)

data_long
```

```{r} 
# Ensure Social_interaction_ratio is numeric
data_long$Social_interaction_ratio <- as.numeric(data_long$Social_interaction_ratio)

# Convert Group to a factor with specific order and labels
data_long$Group <- factor(data_long$Group, 
                      levels = c("Con", "Sus", "Res"),
                      labels = c("Control", "Susceptible", "Resilient"))

# Calculate means and standard errors for each group
group_stats <- data_long %>%
  group_by(Group) %>%
  summarise(
    mean = mean(Social_interaction_ratio, na.rm = TRUE),
    se = sd(Social_interaction_ratio, na.rm = TRUE) / sqrt(sum(!is.na(Social_interaction_ratio))),
    n = sum(!is.na(Social_interaction_ratio))
  )

# Create the plot
p <- ggplot() +
  # Add individual data points
  geom_point(data = data_long %>% filter(!is.na(Social_interaction_ratio)), 
             aes(x = Group, y = Social_interaction_ratio, color = Group),
             position = position_jitter(width = 0.2, seed = 123),
             size = 2, alpha = 0.7) +
  
  # Add mean lines
  geom_errorbar(data = group_stats,
                aes(x = Group, ymin = mean, ymax = mean, color = Group),
                width = 0.5, linewidth = 1) +  # Changed from size to linewidth
  
  # Add error bars (standard error)
  geom_errorbar(data = group_stats,
                aes(x = Group, ymin = mean - se, ymax = mean + se, color = Group),
                width = 0.25, linewidth = 0.5) +  # Changed from size to linewidth
  
  # Set colors
  scale_color_manual(values = c("Control" = "black", 
                                "Susceptible" = "#FF9999", 
                                "Resilient" = "#99CCFF")) +
  
  # Set y-axis limits and breaks
  scale_y_continuous(limits = c(0, 300), breaks = seq(0, 300, 100)) +
  
  # Add group sizes at the bottom
  annotate("text", x = 1:3, y = -15, 
           label = paste0("(", group_stats$n, ")"),
           size = 3.5) +
  
  # Customize labels and theme
  labs(y = "Social interaction ratio (%)", x = "") +
  theme_classic() +
  theme(
    legend.position = "none",
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14),
    plot.margin = margin(30, 10, 30, 10)
  )


print(p)


```

